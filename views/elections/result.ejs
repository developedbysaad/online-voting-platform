<html>
  <head>
   <%-include("../layout/head.ejs")%> 
  </style>
  </head>
  <body class="bg-body">
    <% if (admin == true) { %>
      <% if (!election.ended) { %>
        <div class="container flex px-2 mx-auto pt-2 justify-between mt-5 sticky top-0">
          <a href="/election/<%=election.id%>">
            <button class="bg-red-400 boder-2 px-6 py-2 rounded-3xl hover:bg-red-500 text-white" onclick="toggleElectionModal()"> <%= election.name%> &nbsp; <i class="fa fa-home"></i></button>
          </a>
        </div>
        <!-- Election is live -->
        <div class="container mx-auto flex justify-center p-5">
          <div class="flex">
            <div class="animate-pulse rounded-full bg-red-600 h-10 w-10"></div>
            <p class="pl-5 text-4xl text-selected-text"> Election is <span class="text-red-500 font-bold animate-pulse">Live</span> </p>
          </div>
        </div>
        <% } else { %>
          <div class="container flex px-2 mx-auto pt-2 justify-between mt-5 sticky top-0">
            <!-- Edit election name -->
            <a href="/home">
              <button class="bg-red-400 boder-2 px-6 py-2 rounded-3xl hover:bg-red-500 text-white"> Home &nbsp; <i class="fa fa-home"></i></button>
            </a>
          </div>
     <% } %>
      <% } else { %>
        <span class="bg-red-400 boder-2 px-6 py-2  sticky top-5 left-5 rounded-3xl hover:bg-red-500 text-white">Online Voting Platform</span>
        <% } %>
        
   <div class="flex justify-center">
     <p class="pt-2 text-gray-300 text-xl"><%= votesCount %> / <%= totalVoters %> Voters voted</p>
   </div>
        
        <script>
          let data, config, chart;
    </script>
    
     <div class="flex justify-center m-10 p-10 gap-5 flex-wrap">
        <% for (let l=0; l<questions.length; l++) { %>
          <div class="bg-gray-100 border rounded-3xl px-5 pb-5 w-2/5">
            <div class="">
              <p class="font-bold text-xl m-5"><%= l+1 %>. <%= questions[l].title %></p>
              <hr>
              <p class="text-gray-600 m-5"><%= questions[l].description %></p>
            </div>
            <div>
              <canvas id="chart-<%=questions[l].id%>" ></canvas>
            </div>
          </div>
          <% } %>
      </div>
      <script>
      <% for (let k=0; k<questions.length; k++) { %>
    // setup 
    data = {
      labels: <%- JSON.stringify(totalOption[k]) %>,
      datasets: [{
        label: 'Total Votes',
        data: <%- JSON.stringify(totalData[k]) %>,
        backgroundColor: [
          'rgba(255, 26, 104, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',
          'rgba(153, 102, 255, 0.2)',
          'rgba(255, 159, 64, 0.2)',
          'rgba(0, 0, 0, 0.2)'
        ],
        borderColor: [
          'rgba(255, 26, 104, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(255, 159, 64, 1)',
          'rgba(0, 0, 0, 1)'
        ],
        borderWidth: 1,
        labels: {
        }
        
      }]
    };

    // config 
    config = {
      type: 'pie',
      data,
      options: {}
    };

    // render init block
    myChart = new Chart(
      document.getElementById("chart-<%=questions[k].id%>"),
      config
    );
    <% } %>
    </script>

<% if (admin == true) { %>
  <%- include("votersList.ejs", {voters}) %>
  <% } %>
  </body>
</html>